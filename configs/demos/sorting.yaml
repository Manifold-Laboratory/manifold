model:
  dim: 256
  depth: 8
  heads: 8
  vocab_size: 100  # Numbers 0-99
  max_len: 20  # Sequence length to sort
  use_scan: false  # CRITICAL: Disable scan to use FULL GEODESIC FLOW
  
physics:
  solver: "leapfrog"  # Symplectic is safer for long-chain logic
  stability:
    base_dt: 0.3
    damping: 0.05
    residual_scale: 0.5 # Stability over speed
  
  embedding:
    type: functional # Infinite Input
    coord_dim: 8
    mode: binary

  readout:
    type: binary   # Infinite Output
    
  active_inference:
    enabled: true
    reactive_curvature:
      enabled: true
      plasticity: 0.05
      enabled: true # Enable Context-Dependent Geometry
    
    # Mixture of Manifolds (MoM) Config
    mixture:
      enabled: true
      # Allocating Expert Heads:
      # Head 0: Euclidean (Linear logic)
      # Head 1: Hyperbolic (Recursive/Tree logic)
      # Head 2: Spherical (Cyclic logic)
      # Head 3: Hyper-Christoffel (Adaptive logic)
      components:
        euclidean: [0]
        hyperbolic: [1]
        spherical: [2]
        learnable: [3]
    
training:
  batch_size: 256
  lr: 0.0005 # Discovery: geometric models need lower LR
  epochs: 50
  grad_clip: 0.1 # Discovery: tight clipping is mandatory for ODEs
  log_every: 20
  save_dir: "checkpoints/sorting"
  seed: 42
  
task:
  seq_len: 10
  num_train: 5000
  num_val: 500
  vocab: 100
